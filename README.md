# Diploma_HSE_DataDrift_2023
Дипломная работа на тему: Разработка системы оценки деградации качества предсказания моделей машинного обучения


Когда компания получает заявку на кредит, ей необходимо принять решение о выдаче кредита на основе профиля заявителя. Существуют два типа рисков, связанных с решением банка:
- Если заявитель вероятно будет платить по кредиту, то отказ в выдаче кредита приводит к потере бизнеса для компании.
- Если заявитель вероятно не будет платить по кредиту, т.е. скорее всего не вернет долг, то выдача кредита может привести к финансовым потерям для компании.

Данные содержат информацию о прошлых заявителях на кредит и о том, были ли они «дефолтом» или нет. Цель заключается в выявлении шаблонов, которые указывают на вероятность дефолта человека, которые могут быть использованы для принятия мер, таких как отказ в кредите, снижение суммы кредита, выдача кредита (рискованным заявителям) по более высокой процентной ставке и т.д.

Когда человек подает заявку на кредит, компания может принять два типа решений:

1) Loan accepted: если компания одобряет кредит, возможны 3 сценария, описанные ниже:
- Fully paid: заявитель полностью выплатил кредит (основную сумму и процентную ставку).
- Current: заявитель находится в процессе выплаты рассрочки, т.е. срок кредита еще не истек. Эти кандидаты не помечены как «дефолт».
- Charged-off: заявитель не выплатил рассрочку вовремя в течение длительного периода времени, т.е. он не выполнил обязательства по кредиту.

2) Loan rejected: компания отказала в выдаче кредита (потому что кандидат не соответствует их требованиям и т.д.). Поскольку кредит был отклонен, нет истории транзакций этих заявителей с компанией, и эти данные недоступны компании (и, следовательно, в этом наборе данных).

Информация об этом конкретном наборе данных (представлена лишь часть):

| Название признака      | Описание признака                                                                                          |
|-----------------------|------------------------------------------------------------------------------------------------------------|
| loan_amnt             | Запрашиваемая сумма кредита                                                                                |
| term                  | Количество платежей по кредиту в месяцах (36 или 60)                                                      |
| int_rate              | Процентная ставка по кредиту                                                                               |
| installment           | Ежемесячный платеж, который должен быть уплачен заемщиком в случае одобрения кредита                     |
| grade                 | Рейтинг кредитоспособности заемщика, присвоенный LendingClub                                               |
| sub_grade             | Подрейтинг кредитоспособности заемщика, присвоенный LendingClub                                           |
| emp_title             | Название занимаемой должности заемщика, указанное им при подаче заявки                                   |
| emp_length            | Стаж работы заемщика в годах                                                                              |
| home_ownership        | Статус домовладения заемщика: RENT (аренда), OWN (владеет), MORTGAGE (ипотека), OTHER (другое)           |
| annual_inc            | Самостоятельно заявленный годовой доход заемщика                                                          |
| verification_status   | Указывает, был ли подтвержден доход заемщика LendingClub, не подтвержден либо было подтверждено другое источник |
| issue_d               | Месяц, в котором был выдан кредит                                                                          |
| loan_status           | Текущий статус кредита                                                                                     |
| purpose               | Категория, указанная заемщиком при запросе кредита                                                         |
| title                 | Название кредита, указанное заемщиком                                                                      |
| zip_code              | Первые 3 цифры почтового индекса, указанного заемщиком в заявке                                            |
| addr_state            | Штат, указанный заемщиком в заявке                                                                         |
| dti                   | Соотношение суммы ежемесячных платежей по всем долгам, исключая ипотеку, и запрашиваемой суммы кредита    |
| earliest_cr_line      | Месяц, в котором была открыта первая кредитная линия заемщика                                              |
| open_acc              | Количество открытых кредитных линий в кредитной истории заемщика                                           |
| pub_rec               | Количество общественных записей о дефолте заемщика                                                         |
| revol_bal             | Общий оборот по возобновляемым кредитам                                                                    |
| total_acc             | Общее количество кредитных линий в кредитной истории заемщика                                              |

Реализованы следующие модели:

1. [Реализация модели ARIMA](ARIMA.ipynb)

Полученные метрики:
- MAE: 9761.207347318743
- MSE: 162031927.76585966
- R2: -1.102952782860616

2. [Реализация модели RandomForest](RandomForest_new.ipynb)

Полученные метрики:
- MAE: 0.004171900900164276
- MSE: 0.0014656161033516437
- R2: 0.9908335863193296
Значения доп.метрик:
- MAPE: 8983698894687.07
- Pearson correlation: 0.9954127364021306
- Spearman correlation: 0.9181137457003917
- Kendall correlation: 0.8954131231122289
- RMSLE: 0.027424204789724276

3. [Модель RandomForest  с применением кросс-валидации](RandomForest_with_cros_val.ipynb)

Полученные метрики:
- Cross-validation scores:  [-0.00561514 -0.00095901 -0.00329544 -0.00311084 -0.00134374]
- Mean squared error:  0.00286483643175179
